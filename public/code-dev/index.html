<html>
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="manifest" href="/code-dev/manifest.json">
	
	<!-- FileHandling Origin Trial Tag -->
	<meta http-equiv="origin-trial" content="Any5ZMxapcnyPRU6oaXf0kLl9P9F9MenwujJJcA1PlbIwLqpudQMO/W62fOwE+0WPWyhfZTBeWm8tS9fFJ8ALwAAAABVeyJvcmlnaW4iOiJodHRwczovL2NvZGUuamFrYm94Lm5ldDo0NDMiLCJmZWF0dXJlIjoiRmlsZUhhbmRsaW5nIiwiZXhwaXJ5IjoxNjM0MDgzMTk5fQ==">
	
	<!--<link rel='stylesheet' href='/material-icons.woff2' media='screen,projection' type='text/css'>-->
	<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
	
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Roboto+Mono&family=Roboto:wght@300;400&display=swap" rel="stylesheet">
	
	<link href="css/elements.css" rel="stylesheet">
	<link href="css/main.css" rel="stylesheet" />
	
	<script src="ace/ace.js" type="text/javascript" charset="utf-8"></script>
	<script src="ace/ext-language_tools.js"></script>
	
	
	<script type="text/javascript" src="js/elements.js" ></script>
	<script type="text/javascript">window.elements=window.__ui</script>
	<script type="text/javascript">
	    const notSupported = []
	    
	    /* Only show the page if we have support for File System Access API */
		if(!('showDirectoryPicker' in window)) { notSupported.push("FilesAPI"); }
		if(!('serviceWorker' in navigator)) { notSupported.push("ServiceWorker"); }
		
		if(notSupported.length > 0) {
		    console.log(notSupported)
		    sessionStorage.setItem("notSupported", JSON.stringify(notSupported));
            window.location.href = "./notSupported.html"
		} else {
    		/* Only register a service worker if it's supported */
    		if ('serviceWorker' in navigator) { navigator.serviceWorker.register('/code-dev/service-worker.js'); }
		}
	</script>
	<script>
        const bc = window.filesReceiver = new BroadcastChannel("file_open_request_dev")
        window.activeFileReceiver = true
        window.onfocus=()=>{ bc.postMessage("connected"); window.activeFileReceiver = true }
        bc.addEventListener("message", e=>{  if(e.data == "connected") { window.activeFileReceiver = false }  })
        bc.postMessage("connected")
	</script>
	<style> :root { --theme: #00aabb!important; } </style>
</head>
<body>
	<ui-actionbar id="menu" hook="top" slim style="top: 0px; bottom: auto;">
	    <ui-inline id="logo"><img src="images/code-192-simple.svg" style="color: #fff" height="32px"> Code DEV</ui-inline>
	    <ui-button id="menu_file">File</ui-button>
	    <ui-button id="menu_edit">Edit</ui-button>
	    <ui-button id="menu_project">Folders</ui-button>
	    <ui-button id="menu_settings">Settings</ui-button>
	</ui-actionbar>

	<ui-actionbar id="statusbar" slim hook="bottom">
	    <ui-button id="settings" icon="settings" hook=right onclick="editor.execCommand('showEditorSettings')"></ui-button>
	    <ui-button id="theme_select" hook=right></ui-button>
	    <ui-button  id="mode_select" hook=right></ui-button>
	</ui-actionbar>
	
	<ui-menu attachTo="#menu_file" onclick="(e)=>{editor.execCommand(e)}">
	    <ui-menu-item command="newFile" icon="note_add" keyTag="Ctrl-N">New File</ui-menu-item>
	    <ui-menu-item command="openFile" keyTag="Ctrl-O">Open File</ui-menu-item>
	    <ui-menu-split></ui-menu-split>
	    <ui-menu-item command="saveFile" icon="save" keyTag="Ctrl-S">Save File</ui-menu-item>
	    <ui-menu-item command="saveFileAs" keyTag="Ctrl-Shift-S">Save File As ...</ui-menu-item>
	    <ui-menu-split></ui-menu-split>
	    <!--<ui-menu-item>Save All</ui-menu-item>-->
	    <ui-menu-item command="closeFile" icon="close" keyTag="Ctrl-W">Close File</ui-menu-item>
	    <!--<ui-menu-item>Exit</ui-menu-item>-->
    </ui-menu>

	<ui-menu attachTo="#menu_edit" onclick="(e)=>{ window.ui.command(e) }">
	    <ui-menu-item command="undo" icon="undo" keyTag="Ctrl-Z">Undo</ui-menu-item>
	    <ui-menu-item command="redo" icon="redo" keyTag="Ctrl-Y">Redo</ui-menu-item>
	    <ui-menu-split></ui-menu-split>
	    <ui-menu-item command="app:find" icon="search" keyTag="Ctrl-F">Find</ui-menu-item>
	    <ui-menu-item command="app:find-next" keyTag="F3">Find Next</ui-menu-item>
	    <ui-menu-item command="app:find-regex" keyTag="Ctrl-Shift-F">Find (Regex)</ui-menu-item>
	    <ui-menu-split></ui-menu-split>
	    <ui-menu-item command="app:goto" keyTag="Ctrl-G">Goto Line</ui-menu-item>
	    <ui-menu-split></ui-menu-split>
	    <ui-menu-item command="splitIntoLines" keyTag="Ctrl-Shift-L">Cursor per line of selection</ui-menu-item>
	    <ui-menu-split></ui-menu-split>
	    <ui-menu-item command="indent" icon="format_indent_increase" keyTag="Ctrl-]">Indent Selection</ui-menu-item>
	    <ui-menu-item command="outdent" icon="format_indent_decrease" keyTag="Ctrl-[">Outdent Selection</ui-menu-item>
	    <ui-menu-split></ui-menu-split>
	    <ui-menu-item command="togglecomment" icon="short_text" keyTag="Ctrl-/">Toggle Comment</ui-menu-item>
	    <ui-menu-item command="toggleBlockComment" icon="notes" keyTag="Ctrl-Shift-/">Toggle Block Comment</ui-menu-item>
    </ui-menu>

	<ui-menu attachTo="#menu_project" onclick="(e)=>{editor.focus(); editor.execCommand(e)}">
	    <ui-menu-item command="toggleFolders" icon="menu_open">Toggle File List</ui-menu-item>
	    <ui-menu-split></ui-menu-split>
	    <ui-menu-item command="addFolder" icon="create_new_folder">Add Folder</ui-menu-item>
	    <ui-menu-item command="refreshFolders" icon="refresh">Refresh Folders</ui-menu-item>
	    <ui-menu-item command="removeAllFolders" icon="close">Remove All Folders</ui-menu-item>
    </ui-menu>

	<ui-menu attachTo="#menu_settings" onclick="(e)=>{editor.focus(); editor.execCommand(e)}">
	    <ui-menu-item command="showEditorSettings" icon="settings">Editor Settings</ui-menu-item>
	    <ui-menu-split></ui-menu-split>
	    <ui-menu-item command="showAbout" icon="info">About Code</ui-menu-item>
    </ui-menu>
    
    <ui-menu id="top_file_context" onclick="(e)=>{ console.log(e) }">
	    <ui-menu-item command="refresh" icon="refresh">Refresh Folder</ui-menu-item>
	    <ui-menu-item command="remove" icon="close">Remove Folder</ui-menu-item>
    </ui-menu>

    <ui-menu id="file_context" onclick="(e)=>{ console.log(e) }">
	    <ui-menu-item command="refresh" icon="refresh">Refresh Folder</ui-menu-item>
    </ui-menu>
    
    
    <!--<ui-panel type='modal' blank>-->
    <!--    <h1>Stuff goes here!</h1>-->
    <!--    <p>more stuff here</p>-->
    <!--</ui-panel>-->

	<script type="module" src="js/main.mjs"></script>
</body>
</html>